# lark-next-boilerplate

Larkï¼ˆæ—§Feishuï¼‰èªè¨¼ã‚’çµ±åˆã—ãŸNext.js 15ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚

## ğŸ¯ ä¸»ãªæ©Ÿèƒ½

- **Lark OAuthèªè¨¼**: Lark Suite APIã‚’ä½¿ç”¨ã—ãŸOAuth 2.0èªè¨¼ãƒ•ãƒ­ãƒ¼
- **ãƒˆãƒ¼ã‚¯ãƒ³è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥**: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®è‡ªå‹•æ›´æ–°æ©Ÿèƒ½
- **ã‚»ã‚­ãƒ¥ã‚¢ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼ã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼çŠ¶æ…‹ä¿æŒ
- **ãƒ¢ãƒ€ãƒ³UI**: Tailwind CSS + shadcn/ui ã«ã‚ˆã‚‹ç¾ä»£çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
- **å‹å®‰å…¨æ€§**: TypeScript + Zod ã«ã‚ˆã‚‹å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯

## ğŸ“‹ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 15 (App Router)
- **è¨€èª**: TypeScript
- **èªè¨¼**: Lark Suite OAuth 2.0
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS
- **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: shadcn/ui
- **å‹æ¤œè¨¼**: Zod
- **ã‚¢ã‚¤ã‚³ãƒ³**: Lucide React

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm run lark:init
```

ã¾ãŸã¯å€‹åˆ¥ã«å®Ÿè¡Œï¼š

```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm run lark:install

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
npm run lark:setup
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ã€Larkã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®Credentialsã‚’è¨­å®šï¼š

```env
LARK_APP_ID=your_app_id
LARK_APP_SECRET=your_app_secret
NEXT_PUBLIC_LARK_APP_ID=your_app_id
NEXT_PUBLIC_LARK_REDIRECT_URI=http://localhost:3000/api/auth/callback
```

### 3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

[http://localhost:3000](http://localhost:3000) ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
lark-next-boilerplate/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/callback/       # OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯API
â”‚   â”‚   â”‚   â””â”€â”€ lark/user-info/      # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—APIï¼ˆè‡ªå‹•æ›´æ–°å¯¾å¿œï¼‰
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts              # èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ lark.ts              # åŸºæœ¬Lark SDKè¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ lark-client.ts       # è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ login/                   # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ env.ts                   # ç’°å¢ƒå¤‰æ•°ã®å‹å®‰å…¨ãªç®¡ç†
â”‚   â”‚   â”œâ”€â”€ layout.tsx               # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â””â”€â”€ page.tsx                 # ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                      # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ user/                    # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ login-form.tsx           # ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ lark.ts                  # Lark SDKè¨­å®š
â”‚   â”‚   â””â”€â”€ utils.ts                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ user.ts                  # ãƒ¦ãƒ¼ã‚¶ãƒ¼å‹å®šç¾©
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ lark-setup.sh               # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ setup.js                     # Node.jsã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ middleware.ts                    # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â””â”€â”€ components.json                  # shadcn/uiè¨­å®š
```

## ğŸ” èªè¨¼ãƒ•ãƒ­ãƒ¼

1. **ãƒ­ã‚°ã‚¤ãƒ³**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒLarkã§ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **OAuthèªè¨¼**: Larkèªè¨¼ã‚µãƒ¼ãƒãƒ¼ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
3. **ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯**: èªè¨¼æˆåŠŸå¾Œã€`/api/auth/callback`ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
4. **ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—**: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
5. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºç«‹**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
6. **ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹**: èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹

## ğŸ”„ è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼

```mermaid
graph TD
    A[APIå‘¼ã³å‡ºã—è¦æ±‚] --> B{ãƒˆãƒ¼ã‚¯ãƒ³å­˜åœ¨ç¢ºèª}
    B -->|ãƒˆãƒ¼ã‚¯ãƒ³ãªã—| Z[èªè¨¼ã‚¨ãƒ©ãƒ¼]
    B -->|ãƒˆãƒ¼ã‚¯ãƒ³ã‚ã‚Š| C{ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ãƒã‚§ãƒƒã‚¯}
    
    C -->|æœŸé™å†…| F[APIå®Ÿè¡Œ]
    C -->|æœŸé™åˆ‡ã‚Œ| D[ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨]
    
    D --> E{ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°æˆåŠŸï¼Ÿ}
    E -->|æˆåŠŸ| G[æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã§APIå®Ÿè¡Œ]
    E -->|å¤±æ•—| H[èªè¨¼ã‚¨ãƒ©ãƒ¼ - å†ãƒ­ã‚°ã‚¤ãƒ³è¦æ±‚]
    
    F --> I{APIå‘¼ã³å‡ºã—æˆåŠŸï¼Ÿ}
    G --> I
    
    I -->|æˆåŠŸ| J[çµæœè¿”å´ & Cookieæ›´æ–°]
    I -->|æœŸé™åˆ‡ã‚Œã‚¨ãƒ©ãƒ¼<br/>Code: 99991677| K{ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ï¼Ÿ}
    I -->|ãã®ä»–ã‚¨ãƒ©ãƒ¼| L[ã‚¨ãƒ©ãƒ¼è¿”å´]
    
    K -->|ãƒªãƒˆãƒ©ã‚¤å›æ•°å†…| M[å¼·åˆ¶ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°]
    K -->|ãƒªãƒˆãƒ©ã‚¤é™ç•Œ| L
    
    M --> D
    
    style A fill:#e1f5fe
    style J fill:#c8e6c9
    style H fill:#ffcdd2
    style L fill:#ffcdd2
    style Z fill:#ffcdd2
```

### ğŸ”§ è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ã®ç‰¹å¾´

- **ãƒ—ãƒ­ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ›´æ–°**: ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ã®1.5æ™‚é–“å‰ã«è‡ªå‹•æ›´æ–°
- **ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ›´æ–°**: APIå‘¼ã³å‡ºã—æ™‚ã®ã‚¨ãƒ©ãƒ¼ã«åŸºã¥ãè‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
- **æœ€å¤§2å›ã®ãƒªãƒˆãƒ©ã‚¤**: å¤±æ•—æ™‚ã®è‡ªå‹•å¾©æ—§æ©Ÿèƒ½
- **ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªä½“é¨“**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å†ãƒ­ã‚°ã‚¤ãƒ³ã®å¿…è¦ãªã—

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½

- **HTTPOnly Cookie**: XSSæ”»æ’ƒã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿è­·
- **ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢èªè¨¼**: å…¨ãƒšãƒ¼ã‚¸ã§èªè¨¼çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
- **ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥**: è‡ªå‹•çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ›´æ–°
- **å‹å®‰å…¨ãªç’°å¢ƒå¤‰æ•°**: Zodã«ã‚ˆã‚‹ç’°å¢ƒå¤‰æ•°ã®æ¤œè¨¼

## ğŸ“ ä¸»è¦ãªAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

- `GET /` - ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ï¼ˆèªè¨¼ãŒå¿…è¦ï¼‰
- `GET /login` - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
- `GET /api/auth/callback` - OAuthèªè¨¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
- `GET /api/lark/user-info` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼ˆè‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°å¯¾å¿œï¼‰

### APIä½¿ç”¨ä¾‹

```typescript
// è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°æ©Ÿèƒ½ä»˜ãAPIå‘¼ã³å‡ºã—
import { autoRefreshLarkClient } from '@/app/lib/lark-client';

const result = await autoRefreshLarkClient.apiCall(async (token) => {
  return await fetch('https://open.larksuite.com/open-apis/contact/v3/users/me', {
    headers: { 
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    }
  });
});
```

## ğŸ¨ UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯[shadcn/ui](https://ui.shadcn.com/)ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ä»¥ä¸‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

- Button
- Card
- Input
- Label
- Avatar
- Dropdown Menu

## ğŸ“¦ ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

- `npm run lark:install` - ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- `npm run lark:setup` - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
- `npm run lark:init` - åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆinstall + setupï¼‰

## ğŸ”§ é–‹ç™ºã®ãƒ’ãƒ³ãƒˆ

### Larkã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®š

1. [Lark Open Platform](https://open.larksuite.com/)ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
2. OAuthè¨­å®šã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’ `http://localhost:3000/api/auth/callback` ã«è¨­å®š
3. å¿…è¦ãªæ¨©é™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±èª­ã¿å–ã‚Šï¼‰ã‚’æœ‰åŠ¹åŒ–

### æ–°ã—ã„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿½åŠ 

```bash
npx shadcn-ui@latest add [component-name]
```

## ğŸ“š å‚è€ƒè³‡æ–™

- [Next.js Documentation](https://nextjs.org/docs)
- [Lark Open Platform](https://open.larksuite.com/document/)
- [shadcn/ui Documentation](https://ui.shadcn.com/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **èªè¨¼ã‚¨ãƒ©ãƒ¼**: ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. **ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¨ãƒ©ãƒ¼**: Larkã‚¢ãƒ—ãƒªè¨­å®šã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’ç¢ºèª
3. **ã‚¹ã‚¿ã‚¤ãƒ«ãŒåæ˜ ã•ã‚Œãªã„**: Tailwind CSSã®è¨­å®šã‚’ç¢ºèª

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚
